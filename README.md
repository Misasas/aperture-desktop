# Aperture Desktop

ローカルの画像・動画ファイルを管理するWindowsデスクトップアプリケーションです。

## 機能

### コア機能
- **Obsidian風サイドバー**: ツリー構造でフォルダを階層表示
- **グリッド表示**: サムネイル付きでファイル一覧を表示（サイズ: S/M/L）
- **ビューアー**: 画像・動画をフルスクリーンで表示
- **タグ機能**: フォルダ単位でタグを付与・検索
- **テーマ**: ライト/ダーク/クリーム

### ファイル操作
- 新規フォルダ作成
- ファイル・フォルダの名前変更（拡張子保護付き）
- ゴミ箱に移動（削除）
- ドラッグ&ドロップ（外部ファイルのインポート対応）
- フォルダ間のアイテム移動（サイドバー内ドラッグ対応）
- エクスプローラーで開く

### UI/UX
- **カスタムタイトルバー**: Windowsネイティブ風デザイン
- **サイドバーリサイズ**: ドラッグでサイズ調整可能
- **インデックス番号表示**: ファイル名とインデックス番号の切り替え
- **ソート機能**: 名前順・更新日順（昇順・降順）
- **フォルダ履歴**: 最近使用したフォルダをクイック切り替え
- **ローディングオーバーレイ**: パルスアニメーション付き

### パフォーマンス
- **遅延読み込み**: Intersection Observerによるサムネイル遅延読み込み
- **サムネイルキャッシュ**: WebP形式で高速表示
- **無限スクロール**: 大量ファイルの段階的読み込み

## セットアップ

### 必要な環境

- Node.js 20.x 以上
- npm または yarn

### インストール

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動
npm run dev
```

### ビルド

```bash
# 本番用ビルド（開発用）
npm run build

# 実行ファイル作成（インストーラー + ポータブル版）
npm run dist

# Windows用インストーラーのみ作成
npm run dist:win

# ポータブル版のみ作成
npm run dist:portable

# ビルド確認用（インストーラーなし）
npm run dist:dir
```

作成されたファイルは `release/` フォルダに出力されます：
- **NSIS インストーラー**: `Aperture Setup 1.0.0.exe` - 通常のインストーラー（デスクトップショートカット作成）
- **ポータブル版**: `Aperture-Portable-1.0.0.exe` - USBメモリなどで持ち運び可能

**注意事項**:
- 初回ビルド時は依存関係のダウンロードに時間がかかります
- `sharp`ライブラリは自動的にパッケージングされます
- Windows Defender などのセキュリティソフトでスキャンに時間がかかる場合があります

## プロジェクト構造

```
aperture-desktop/
├── src/
│   ├── main/                 # Electronメインプロセス
│   │   ├── main.ts          # エントリーポイント
│   │   ├── preload.ts       # プリロードスクリプト
│   │   └── services/        # バックエンドサービス
│   │       ├── fileSystem.ts    # ファイル操作
│   │       ├── thumbnail.ts     # サムネイル生成
│   │       └── metadata.ts      # タグ管理
│   ├── renderer/             # Reactフロントエンド
│   │   ├── App.tsx          # メインコンポーネント
│   │   ├── components/      # UIコンポーネント
│   │   ├── hooks/           # カスタムフック
│   │   └── styles/          # CSSスタイル
│   └── shared/               # 共有型定義
│       └── types.ts
├── index.html
├── package.json
├── tsconfig.json
└── vite.config.ts
```

## 使い方

### 初回起動
1. アプリを起動
2. 管理したいルートフォルダを選択
3. サイドバーにフォルダツリーが表示されます

### 基本操作
- **フォルダ切り替え**: サイドバーのフォルダをクリック
- **ファイル閲覧**: グリッドアイテムをクリックしてビューアーを開く
- **フォルダ移動**: サイドバーのダブルクリックでメインコンテンツに表示
- **ファイル操作**: 右クリックでコンテキストメニューを表示
- **サムネイルサイズ変更**: タイトルバーの S/M/L ボタン
- **インデックス表示**: タイトルバーの #/ABC ボタンで切り替え

### ドラッグ&ドロップ
- **外部ファイル**: エクスプローラーからファイルをドラッグして追加
- **フォルダ移動**: サイドバー内でフォルダをドラッグして移動
- **ルートへ移動**: サイドバー下部の空白エリアにドロップ

## キーボードショートカット

### グローバル
| キー | 動作 |
|------|------|
| Backspace | 親フォルダに戻る |
| F5 | 表示を更新 |
| Ctrl+B | サイドバー表示/非表示 |

### ビューアー
| キー | 動作 |
|------|------|
| ← | 前の画像 |
| → | 次の画像 |
| Esc | ビューアーを閉じる |

## 技術スタック

- **Electron**: デスクトップアプリフレームワーク
- **React**: UIライブラリ
- **TypeScript**: 型安全な開発
- **Vite**: 高速ビルドツール
- **Sharp**: 画像処理（サムネイル生成）
- **Chokidar**: ファイル監視

## ライセンス

MIT
